{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar hase = require('hase'),\n  retry = require('async-retry');\nvar Receiver = /*#__PURE__*/\nfunction () {\n  function Receiver(_ref) {\n    var url = _ref.url,\n      application = _ref.application,\n      prefetch = _ref.prefetch;\n    (0, _classCallCheck2.default)(this, Receiver);\n    if (!url) {\n      throw new Error('Url is missing.');\n    }\n    if (!application) {\n      throw new Error('Application is missing.');\n    }\n    this.url = url;\n    this.application = application;\n    this.prefetch = prefetch;\n  }\n  (0, _createClass2.default)(Receiver, [{\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)(/*#__PURE__*/\n      _regenerator.default.mark(function _callee2(app, incoming, outgoing) {\n        var _this = this;\n        var logger, mq, readStream;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (app) {\n                  _context2.next = 2;\n                  break;\n                }\n                throw new Error('App is missing.');\n              case 2:\n                if (incoming) {\n                  _context2.next = 4;\n                  break;\n                }\n                throw new Error('Incoming is missing.');\n              case 4:\n                if (outgoing) {\n                  _context2.next = 6;\n                  break;\n                }\n                throw new Error('Outgoing is missing.');\n              case 6:\n                logger = app.services.getLogger();\n                _context2.prev = 7;\n                _context2.next = 10;\n                return retry(/*#__PURE__*/\n                (0, _asyncToGenerator2.default)(/*#__PURE__*/\n                _regenerator.default.mark(function _callee() {\n                  var url, prefetch, connection;\n                  return _regenerator.default.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          url = _this.url, prefetch = _this.prefetch;\n                          _context.next = 3;\n                          return hase.connect({\n                            url: url,\n                            prefetch: prefetch\n                          });\n                        case 3:\n                          connection = _context.sent;\n                          return _context.abrupt(\"return\", connection);\n                        case 5:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })));\n              case 10:\n                mq = _context2.sent;\n                _context2.next = 16;\n                break;\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](7);\n                return _context2.abrupt(\"return\", incoming.emit('error', _context2.t0));\n              case 16:\n                mq.on('error', function (errMq) {\n                  incoming.emit('error', errMq);\n                });\n                mq.on('disconnect', function () {\n                  incoming.emit('disconnect');\n                });\n                _context2.prev = 18;\n                _context2.next = 21;\n                return mq.worker(\"\".concat(this.application, \"::flows\")).createReadStream();\n              case 21:\n                readStream = _context2.sent;\n                _context2.next = 27;\n                break;\n              case 24:\n                _context2.prev = 24;\n                _context2.t1 = _context2[\"catch\"](18);\n                return _context2.abrupt(\"return\", incoming.emit('error', _context2.t1));\n              case 27:\n                logger.debug('Started flowbus (receiver) endpoint.', {\n                  url: this.url,\n                  application: this.application\n                });\n                readStream.on('data', function (message) {\n                  var event;\n                  try {\n                    event = app.Event.wrap(message.payload);\n                  } catch (ex) {\n                    logger.warn('Discarding event...', event);\n                    return message.discard();\n                  }\n                  event.next = message.next;\n                  event.discard = message.discard;\n                  event.defer = message.defer;\n                  incoming.write(event);\n                });\n              case 29:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[7, 13], [18, 24]]);\n      }));\n      function link(_x, _x2, _x3) {\n        return _link.apply(this, arguments);\n      }\n      return link;\n    }()\n  }]);\n  return Receiver;\n}();\nmodule.exports = Receiver;","map":{"version":3,"names":["_interopRequireDefault","require","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","hase","retry","Receiver","_ref","url","application","prefetch","default","Error","key","value","_link","mark","_callee2","app","incoming","outgoing","_this","logger","mq","readStream","wrap","_callee2$","_context2","prev","next","services","getLogger","_callee","connection","_callee$","_context","connect","sent","abrupt","stop","t0","emit","on","errMq","worker","concat","createReadStream","t1","debug","message","event","Event","payload","ex","warn","discard","defer","write","link","_x","_x2","_x3","apply","arguments","module","exports"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/tailwind/dist/wires/flowbus/amqp/Receiver.js"],"sourcesContent":["'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar hase = require('hase'),\n    retry = require('async-retry');\n\nvar Receiver =\n/*#__PURE__*/\nfunction () {\n  function Receiver(_ref) {\n    var url = _ref.url,\n        application = _ref.application,\n        prefetch = _ref.prefetch;\n    (0, _classCallCheck2.default)(this, Receiver);\n\n    if (!url) {\n      throw new Error('Url is missing.');\n    }\n\n    if (!application) {\n      throw new Error('Application is missing.');\n    }\n\n    this.url = url;\n    this.application = application;\n    this.prefetch = prefetch;\n  }\n\n  (0, _createClass2.default)(Receiver, [{\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee2(app, incoming, outgoing) {\n        var _this = this;\n\n        var logger, mq, readStream;\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (app) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw new Error('App is missing.');\n\n              case 2:\n                if (incoming) {\n                  _context2.next = 4;\n                  break;\n                }\n\n                throw new Error('Incoming is missing.');\n\n              case 4:\n                if (outgoing) {\n                  _context2.next = 6;\n                  break;\n                }\n\n                throw new Error('Outgoing is missing.');\n\n              case 6:\n                logger = app.services.getLogger();\n                _context2.prev = 7;\n                _context2.next = 10;\n                return retry(\n                /*#__PURE__*/\n                (0, _asyncToGenerator2.default)(\n                /*#__PURE__*/\n                _regenerator.default.mark(function _callee() {\n                  var url, prefetch, connection;\n                  return _regenerator.default.wrap(function _callee$(_context) {\n                    while (1) {\n                      switch (_context.prev = _context.next) {\n                        case 0:\n                          url = _this.url, prefetch = _this.prefetch;\n                          _context.next = 3;\n                          return hase.connect({\n                            url: url,\n                            prefetch: prefetch\n                          });\n\n                        case 3:\n                          connection = _context.sent;\n                          return _context.abrupt(\"return\", connection);\n\n                        case 5:\n                        case \"end\":\n                          return _context.stop();\n                      }\n                    }\n                  }, _callee);\n                })));\n\n              case 10:\n                mq = _context2.sent;\n                _context2.next = 16;\n                break;\n\n              case 13:\n                _context2.prev = 13;\n                _context2.t0 = _context2[\"catch\"](7);\n                return _context2.abrupt(\"return\", incoming.emit('error', _context2.t0));\n\n              case 16:\n                mq.on('error', function (errMq) {\n                  incoming.emit('error', errMq);\n                });\n                mq.on('disconnect', function () {\n                  incoming.emit('disconnect');\n                });\n                _context2.prev = 18;\n                _context2.next = 21;\n                return mq.worker(\"\".concat(this.application, \"::flows\")).createReadStream();\n\n              case 21:\n                readStream = _context2.sent;\n                _context2.next = 27;\n                break;\n\n              case 24:\n                _context2.prev = 24;\n                _context2.t1 = _context2[\"catch\"](18);\n                return _context2.abrupt(\"return\", incoming.emit('error', _context2.t1));\n\n              case 27:\n                logger.debug('Started flowbus (receiver) endpoint.', {\n                  url: this.url,\n                  application: this.application\n                });\n                readStream.on('data', function (message) {\n                  var event;\n\n                  try {\n                    event = app.Event.wrap(message.payload);\n                  } catch (ex) {\n                    logger.warn('Discarding event...', event);\n                    return message.discard();\n                  }\n\n                  event.next = message.next;\n                  event.discard = message.discard;\n                  event.defer = message.defer;\n                  incoming.write(event);\n                });\n\n              case 29:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[7, 13], [18, 24]]);\n      }));\n\n      function link(_x, _x2, _x3) {\n        return _link.apply(this, arguments);\n      }\n\n      return link;\n    }()\n  }]);\n  return Receiver;\n}();\n\nmodule.exports = Receiver;"],"mappings":"AAAA,YAAY;;AAEZ,IAAIA,sBAAsB,GAAGC,OAAO,CAAC,8CAA8C,CAAC;AAEpF,IAAIC,YAAY,GAAGF,sBAAsB,CAACC,OAAO,CAAC,4BAA4B,CAAC,CAAC;AAEhF,IAAIE,kBAAkB,GAAGH,sBAAsB,CAACC,OAAO,CAAC,yCAAyC,CAAC,CAAC;AAEnG,IAAIG,gBAAgB,GAAGJ,sBAAsB,CAACC,OAAO,CAAC,uCAAuC,CAAC,CAAC;AAE/F,IAAII,aAAa,GAAGL,sBAAsB,CAACC,OAAO,CAAC,oCAAoC,CAAC,CAAC;AAEzF,IAAIK,IAAI,GAAGL,OAAO,CAAC,MAAM,CAAC;EACtBM,KAAK,GAAGN,OAAO,CAAC,aAAa,CAAC;AAElC,IAAIO,QAAQ,GACZ;AACA,YAAY;EACV,SAASA,QAAQA,CAACC,IAAI,EAAE;IACtB,IAAIC,GAAG,GAAGD,IAAI,CAACC,GAAG;MACdC,WAAW,GAAGF,IAAI,CAACE,WAAW;MAC9BC,QAAQ,GAAGH,IAAI,CAACG,QAAQ;IAC5B,CAAC,CAAC,EAAER,gBAAgB,CAACS,OAAO,EAAE,IAAI,EAAEL,QAAQ,CAAC;IAE7C,IAAI,CAACE,GAAG,EAAE;MACR,MAAM,IAAII,KAAK,CAAC,iBAAiB,CAAC;IACpC;IAEA,IAAI,CAACH,WAAW,EAAE;MAChB,MAAM,IAAIG,KAAK,CAAC,yBAAyB,CAAC;IAC5C;IAEA,IAAI,CAACJ,GAAG,GAAGA,GAAG;IACd,IAAI,CAACC,WAAW,GAAGA,WAAW;IAC9B,IAAI,CAACC,QAAQ,GAAGA,QAAQ;EAC1B;EAEA,CAAC,CAAC,EAAEP,aAAa,CAACQ,OAAO,EAAEL,QAAQ,EAAE,CAAC;IACpCO,GAAG,EAAE,MAAM;IACXC,KAAK,EAAE,YAAY;MACjB,IAAIC,KAAK,GAAG,CAAC,CAAC,EAAEd,kBAAkB,CAACU,OAAO,EAC1C;MACAX,YAAY,CAACW,OAAO,CAACK,IAAI,CAAC,SAASC,QAAQA,CAACC,GAAG,EAAEC,QAAQ,EAAEC,QAAQ,EAAE;QACnE,IAAIC,KAAK,GAAG,IAAI;QAEhB,IAAIC,MAAM,EAAEC,EAAE,EAAEC,UAAU;QAC1B,OAAOxB,YAAY,CAACW,OAAO,CAACc,IAAI,CAAC,SAASC,SAASA,CAACC,SAAS,EAAE;UAC7D,OAAO,CAAC,EAAE;YACR,QAAQA,SAAS,CAACC,IAAI,GAAGD,SAAS,CAACE,IAAI;cACrC,KAAK,CAAC;gBACJ,IAAIX,GAAG,EAAE;kBACPS,SAAS,CAACE,IAAI,GAAG,CAAC;kBAClB;gBACF;gBAEA,MAAM,IAAIjB,KAAK,CAAC,iBAAiB,CAAC;cAEpC,KAAK,CAAC;gBACJ,IAAIO,QAAQ,EAAE;kBACZQ,SAAS,CAACE,IAAI,GAAG,CAAC;kBAClB;gBACF;gBAEA,MAAM,IAAIjB,KAAK,CAAC,sBAAsB,CAAC;cAEzC,KAAK,CAAC;gBACJ,IAAIQ,QAAQ,EAAE;kBACZO,SAAS,CAACE,IAAI,GAAG,CAAC;kBAClB;gBACF;gBAEA,MAAM,IAAIjB,KAAK,CAAC,sBAAsB,CAAC;cAEzC,KAAK,CAAC;gBACJU,MAAM,GAAGJ,GAAG,CAACY,QAAQ,CAACC,SAAS,CAAC,CAAC;gBACjCJ,SAAS,CAACC,IAAI,GAAG,CAAC;gBAClBD,SAAS,CAACE,IAAI,GAAG,EAAE;gBACnB,OAAOxB,KAAK,CACZ;gBACA,CAAC,CAAC,EAAEJ,kBAAkB,CAACU,OAAO,EAC9B;gBACAX,YAAY,CAACW,OAAO,CAACK,IAAI,CAAC,SAASgB,OAAOA,CAAA,EAAG;kBAC3C,IAAIxB,GAAG,EAAEE,QAAQ,EAAEuB,UAAU;kBAC7B,OAAOjC,YAAY,CAACW,OAAO,CAACc,IAAI,CAAC,SAASS,QAAQA,CAACC,QAAQ,EAAE;oBAC3D,OAAO,CAAC,EAAE;sBACR,QAAQA,QAAQ,CAACP,IAAI,GAAGO,QAAQ,CAACN,IAAI;wBACnC,KAAK,CAAC;0BACJrB,GAAG,GAAGa,KAAK,CAACb,GAAG,EAAEE,QAAQ,GAAGW,KAAK,CAACX,QAAQ;0BAC1CyB,QAAQ,CAACN,IAAI,GAAG,CAAC;0BACjB,OAAOzB,IAAI,CAACgC,OAAO,CAAC;4BAClB5B,GAAG,EAAEA,GAAG;4BACRE,QAAQ,EAAEA;0BACZ,CAAC,CAAC;wBAEJ,KAAK,CAAC;0BACJuB,UAAU,GAAGE,QAAQ,CAACE,IAAI;0BAC1B,OAAOF,QAAQ,CAACG,MAAM,CAAC,QAAQ,EAAEL,UAAU,CAAC;wBAE9C,KAAK,CAAC;wBACN,KAAK,KAAK;0BACR,OAAOE,QAAQ,CAACI,IAAI,CAAC,CAAC;sBAC1B;oBACF;kBACF,CAAC,EAAEP,OAAO,CAAC;gBACb,CAAC,CAAC,CAAC,CAAC;cAEN,KAAK,EAAE;gBACLT,EAAE,GAAGI,SAAS,CAACU,IAAI;gBACnBV,SAAS,CAACE,IAAI,GAAG,EAAE;gBACnB;cAEF,KAAK,EAAE;gBACLF,SAAS,CAACC,IAAI,GAAG,EAAE;gBACnBD,SAAS,CAACa,EAAE,GAAGb,SAAS,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;gBACpC,OAAOA,SAAS,CAACW,MAAM,CAAC,QAAQ,EAAEnB,QAAQ,CAACsB,IAAI,CAAC,OAAO,EAAEd,SAAS,CAACa,EAAE,CAAC,CAAC;cAEzE,KAAK,EAAE;gBACLjB,EAAE,CAACmB,EAAE,CAAC,OAAO,EAAE,UAAUC,KAAK,EAAE;kBAC9BxB,QAAQ,CAACsB,IAAI,CAAC,OAAO,EAAEE,KAAK,CAAC;gBAC/B,CAAC,CAAC;gBACFpB,EAAE,CAACmB,EAAE,CAAC,YAAY,EAAE,YAAY;kBAC9BvB,QAAQ,CAACsB,IAAI,CAAC,YAAY,CAAC;gBAC7B,CAAC,CAAC;gBACFd,SAAS,CAACC,IAAI,GAAG,EAAE;gBACnBD,SAAS,CAACE,IAAI,GAAG,EAAE;gBACnB,OAAON,EAAE,CAACqB,MAAM,CAAC,EAAE,CAACC,MAAM,CAAC,IAAI,CAACpC,WAAW,EAAE,SAAS,CAAC,CAAC,CAACqC,gBAAgB,CAAC,CAAC;cAE7E,KAAK,EAAE;gBACLtB,UAAU,GAAGG,SAAS,CAACU,IAAI;gBAC3BV,SAAS,CAACE,IAAI,GAAG,EAAE;gBACnB;cAEF,KAAK,EAAE;gBACLF,SAAS,CAACC,IAAI,GAAG,EAAE;gBACnBD,SAAS,CAACoB,EAAE,GAAGpB,SAAS,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC;gBACrC,OAAOA,SAAS,CAACW,MAAM,CAAC,QAAQ,EAAEnB,QAAQ,CAACsB,IAAI,CAAC,OAAO,EAAEd,SAAS,CAACoB,EAAE,CAAC,CAAC;cAEzE,KAAK,EAAE;gBACLzB,MAAM,CAAC0B,KAAK,CAAC,sCAAsC,EAAE;kBACnDxC,GAAG,EAAE,IAAI,CAACA,GAAG;kBACbC,WAAW,EAAE,IAAI,CAACA;gBACpB,CAAC,CAAC;gBACFe,UAAU,CAACkB,EAAE,CAAC,MAAM,EAAE,UAAUO,OAAO,EAAE;kBACvC,IAAIC,KAAK;kBAET,IAAI;oBACFA,KAAK,GAAGhC,GAAG,CAACiC,KAAK,CAAC1B,IAAI,CAACwB,OAAO,CAACG,OAAO,CAAC;kBACzC,CAAC,CAAC,OAAOC,EAAE,EAAE;oBACX/B,MAAM,CAACgC,IAAI,CAAC,qBAAqB,EAAEJ,KAAK,CAAC;oBACzC,OAAOD,OAAO,CAACM,OAAO,CAAC,CAAC;kBAC1B;kBAEAL,KAAK,CAACrB,IAAI,GAAGoB,OAAO,CAACpB,IAAI;kBACzBqB,KAAK,CAACK,OAAO,GAAGN,OAAO,CAACM,OAAO;kBAC/BL,KAAK,CAACM,KAAK,GAAGP,OAAO,CAACO,KAAK;kBAC3BrC,QAAQ,CAACsC,KAAK,CAACP,KAAK,CAAC;gBACvB,CAAC,CAAC;cAEJ,KAAK,EAAE;cACP,KAAK,KAAK;gBACR,OAAOvB,SAAS,CAACY,IAAI,CAAC,CAAC;YAC3B;UACF;QACF,CAAC,EAAEtB,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;MACzC,CAAC,CAAC,CAAC;MAEH,SAASyC,IAAIA,CAACC,EAAE,EAAEC,GAAG,EAAEC,GAAG,EAAE;QAC1B,OAAO9C,KAAK,CAAC+C,KAAK,CAAC,IAAI,EAAEC,SAAS,CAAC;MACrC;MAEA,OAAOL,IAAI;IACb,CAAC,CAAC;EACJ,CAAC,CAAC,CAAC;EACH,OAAOpD,QAAQ;AACjB,CAAC,CAAC,CAAC;AAEH0D,MAAM,CAACC,OAAO,GAAG3D,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}