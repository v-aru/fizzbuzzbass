{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar jwt = require('jsonwebtoken');\nvar IdentityProvider = require('./IdentityProvider');\nvar Limes = /*#__PURE__*/\nfunction () {\n  function Limes(_ref) {\n    var identityProviders = _ref.identityProviders;\n    (0, _classCallCheck2.default)(this, Limes);\n    if (!identityProviders) {\n      throw new Error('Identity providers are missing.');\n    }\n    if (identityProviders.length === 0) {\n      throw new Error('Identity providers are missing.');\n    }\n    this.identityProviders = identityProviders;\n  }\n  (0, _createClass2.default)(Limes, [{\n    key: \"getIdentityProviderByIssuer\",\n    value: function getIdentityProviderByIssuer(_ref2) {\n      var issuer = _ref2.issuer;\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n      var requestedIdentityProvider = this.identityProviders.find(function (identityProvider) {\n        return identityProvider.issuer === issuer;\n      });\n      if (!requestedIdentityProvider) {\n        throw new Error(\"Issuer '\".concat(issuer, \"' not found.\"));\n      }\n      return requestedIdentityProvider;\n    }\n  }, {\n    key: \"issueToken\",\n    value: function issueToken(_ref3) {\n      var issuer = _ref3.issuer,\n        subject = _ref3.subject,\n        _ref3$payload = _ref3.payload,\n        payload = _ref3$payload === void 0 ? {} : _ref3$payload;\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n      if (!subject) {\n        throw new Error('Subject is missing.');\n      }\n      var identityProvider = this.getIdentityProviderByIssuer({\n        issuer: issuer\n      });\n      var token = jwt.sign(payload, identityProvider.privateKey, {\n        algorithm: 'RS256',\n        subject: subject,\n        issuer: identityProvider.issuer,\n        expiresIn: identityProvider.expiresInMinutes * 60\n      });\n      return token;\n    }\n  }, {\n    key: \"verifyToken\",\n    value: function () {\n      var _verifyToken = (0, _asyncToGenerator2.default)(/*#__PURE__*/\n      _regenerator.default.mark(function _callee(_ref4) {\n        var token, untrustedDecodedToken, identityProvider, decodedToken;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                token = _ref4.token;\n                if (token) {\n                  _context.next = 3;\n                  break;\n                }\n                throw new Error('Token is missing.');\n              case 3:\n                _context.prev = 3;\n                untrustedDecodedToken = jwt.decode(token);\n                _context.next = 10;\n                break;\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](3);\n                throw new Error('Failed to verify token.');\n              case 10:\n                if (untrustedDecodedToken) {\n                  _context.next = 12;\n                  break;\n                }\n                throw new Error('Failed to verify token.');\n              case 12:\n                identityProvider = this.getIdentityProviderByIssuer({\n                  issuer: untrustedDecodedToken.iss\n                });\n                _context.next = 15;\n                return new Promise(function (resolve, reject) {\n                  try {\n                    jwt.verify(token, identityProvider.certificate, {\n                      algorithms: ['RS256'],\n                      issuer: identityProvider.issuer\n                    }, function (err, verifiedToken) {\n                      if (err) {\n                        return reject(new Error('Failed to verify token.'));\n                      }\n                      resolve(verifiedToken);\n                    });\n                  } catch (ex) {\n                    reject(ex);\n                  }\n                });\n              case 15:\n                decodedToken = _context.sent;\n                return _context.abrupt(\"return\", decodedToken);\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 7]]);\n      }));\n      function verifyToken(_x) {\n        return _verifyToken.apply(this, arguments);\n      }\n      return verifyToken;\n    }()\n  }, {\n    key: \"verifyTokenMiddleware\",\n    value: function verifyTokenMiddleware(_ref5) {\n      var _this = this;\n      var issuerForAnonymousTokens = _ref5.issuerForAnonymousTokens;\n      if (!issuerForAnonymousTokens) {\n        throw new Error('Issuer for anonymous tokens is missing.');\n      }\n      return /*#__PURE__*/(\n        function () {\n          var _ref6 = (0, _asyncToGenerator2.default)(/*#__PURE__*/\n          _regenerator.default.mark(function _callee2(req, res, next) {\n            var token, authorizationHeader, authorizationQuery, _authorizationHeader$, _authorizationHeader$2, authorizationType, authorizationValue, decodedToken;\n            return _regenerator.default.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    authorizationHeader = req.headers.authorization, authorizationQuery = req.query.token;\n                    if (authorizationHeader) {\n                      _authorizationHeader$ = authorizationHeader.split(' '), _authorizationHeader$2 = (0, _slicedToArray2.default)(_authorizationHeader$, 2), authorizationType = _authorizationHeader$2[0], authorizationValue = _authorizationHeader$2[1];\n                      if (authorizationType === 'Bearer') {\n                        token = authorizationValue;\n                      }\n                    } else if (authorizationQuery) {\n                      token = authorizationQuery;\n                    }\n                    if (!token) {\n                      _context2.next = 14;\n                      break;\n                    }\n                    _context2.prev = 3;\n                    _context2.next = 6;\n                    return _this.verifyToken({\n                      token: token\n                    });\n                  case 6:\n                    decodedToken = _context2.sent;\n                    _context2.next = 12;\n                    break;\n                  case 9:\n                    _context2.prev = 9;\n                    _context2.t0 = _context2[\"catch\"](3);\n                    return _context2.abrupt(\"return\", res.status(401).end());\n                  case 12:\n                    _context2.next = 15;\n                    break;\n                  case 14:\n                    decodedToken = Limes.issueUntrustedTokenAsJson({\n                      issuer: issuerForAnonymousTokens,\n                      subject: 'anonymous'\n                    });\n                  case 15:\n                    req.user = decodedToken;\n                    next();\n                  case 17:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, null, [[3, 9]]);\n          }));\n          return function (_x2, _x3, _x4) {\n            return _ref6.apply(this, arguments);\n          };\n        }()\n      );\n    }\n  }], [{\n    key: \"issueUntrustedTokenAsJson\",\n    value: function issueUntrustedTokenAsJson(_ref7) {\n      var issuer = _ref7.issuer,\n        subject = _ref7.subject,\n        _ref7$payload = _ref7.payload,\n        payload = _ref7$payload === void 0 ? {} : _ref7$payload;\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n      if (!subject) {\n        throw new Error('Subject is missing.');\n      }\n      var expiresInMinutes = 60;\n      var encodedToken = jwt.sign(payload, null, {\n        algorithm: 'none',\n        subject: subject,\n        issuer: issuer,\n        expiresIn: expiresInMinutes * 60\n      });\n      var token = jwt.decode(encodedToken);\n      return token;\n    }\n  }]);\n  return Limes;\n}();\nLimes.IdentityProvider = IdentityProvider;\nmodule.exports = Limes;","map":{"version":3,"names":["_interopRequireDefault","require","_slicedToArray2","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","jwt","IdentityProvider","Limes","_ref","identityProviders","default","Error","length","key","value","getIdentityProviderByIssuer","_ref2","issuer","requestedIdentityProvider","find","identityProvider","concat","issueToken","_ref3","subject","_ref3$payload","payload","token","sign","privateKey","algorithm","expiresIn","expiresInMinutes","_verifyToken","mark","_callee","_ref4","untrustedDecodedToken","decodedToken","wrap","_callee$","_context","prev","next","decode","t0","iss","Promise","resolve","reject","verify","certificate","algorithms","err","verifiedToken","ex","sent","abrupt","stop","verifyToken","_x","apply","arguments","verifyTokenMiddleware","_ref5","_this","issuerForAnonymousTokens","_ref6","_callee2","req","res","authorizationHeader","authorizationQuery","_authorizationHeader$","_authorizationHeader$2","authorizationType","authorizationValue","_callee2$","_context2","headers","authorization","query","split","status","end","issueUntrustedTokenAsJson","user","_x2","_x3","_x4","_ref7","_ref7$payload","encodedToken","module","exports"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/limes/dist/Limes.js"],"sourcesContent":["'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar jwt = require('jsonwebtoken');\n\nvar IdentityProvider = require('./IdentityProvider');\n\nvar Limes =\n/*#__PURE__*/\nfunction () {\n  function Limes(_ref) {\n    var identityProviders = _ref.identityProviders;\n    (0, _classCallCheck2.default)(this, Limes);\n\n    if (!identityProviders) {\n      throw new Error('Identity providers are missing.');\n    }\n\n    if (identityProviders.length === 0) {\n      throw new Error('Identity providers are missing.');\n    }\n\n    this.identityProviders = identityProviders;\n  }\n\n  (0, _createClass2.default)(Limes, [{\n    key: \"getIdentityProviderByIssuer\",\n    value: function getIdentityProviderByIssuer(_ref2) {\n      var issuer = _ref2.issuer;\n\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n\n      var requestedIdentityProvider = this.identityProviders.find(function (identityProvider) {\n        return identityProvider.issuer === issuer;\n      });\n\n      if (!requestedIdentityProvider) {\n        throw new Error(\"Issuer '\".concat(issuer, \"' not found.\"));\n      }\n\n      return requestedIdentityProvider;\n    }\n  }, {\n    key: \"issueToken\",\n    value: function issueToken(_ref3) {\n      var issuer = _ref3.issuer,\n          subject = _ref3.subject,\n          _ref3$payload = _ref3.payload,\n          payload = _ref3$payload === void 0 ? {} : _ref3$payload;\n\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n\n      if (!subject) {\n        throw new Error('Subject is missing.');\n      }\n\n      var identityProvider = this.getIdentityProviderByIssuer({\n        issuer: issuer\n      });\n      var token = jwt.sign(payload, identityProvider.privateKey, {\n        algorithm: 'RS256',\n        subject: subject,\n        issuer: identityProvider.issuer,\n        expiresIn: identityProvider.expiresInMinutes * 60\n      });\n      return token;\n    }\n  }, {\n    key: \"verifyToken\",\n    value: function () {\n      var _verifyToken = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee(_ref4) {\n        var token, untrustedDecodedToken, identityProvider, decodedToken;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                token = _ref4.token;\n\n                if (token) {\n                  _context.next = 3;\n                  break;\n                }\n\n                throw new Error('Token is missing.');\n\n              case 3:\n                _context.prev = 3;\n                untrustedDecodedToken = jwt.decode(token);\n                _context.next = 10;\n                break;\n\n              case 7:\n                _context.prev = 7;\n                _context.t0 = _context[\"catch\"](3);\n                throw new Error('Failed to verify token.');\n\n              case 10:\n                if (untrustedDecodedToken) {\n                  _context.next = 12;\n                  break;\n                }\n\n                throw new Error('Failed to verify token.');\n\n              case 12:\n                identityProvider = this.getIdentityProviderByIssuer({\n                  issuer: untrustedDecodedToken.iss\n                });\n                _context.next = 15;\n                return new Promise(function (resolve, reject) {\n                  try {\n                    jwt.verify(token, identityProvider.certificate, {\n                      algorithms: ['RS256'],\n                      issuer: identityProvider.issuer\n                    }, function (err, verifiedToken) {\n                      if (err) {\n                        return reject(new Error('Failed to verify token.'));\n                      }\n\n                      resolve(verifiedToken);\n                    });\n                  } catch (ex) {\n                    reject(ex);\n                  }\n                });\n\n              case 15:\n                decodedToken = _context.sent;\n                return _context.abrupt(\"return\", decodedToken);\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[3, 7]]);\n      }));\n\n      function verifyToken(_x) {\n        return _verifyToken.apply(this, arguments);\n      }\n\n      return verifyToken;\n    }()\n  }, {\n    key: \"verifyTokenMiddleware\",\n    value: function verifyTokenMiddleware(_ref5) {\n      var _this = this;\n\n      var issuerForAnonymousTokens = _ref5.issuerForAnonymousTokens;\n\n      if (!issuerForAnonymousTokens) {\n        throw new Error('Issuer for anonymous tokens is missing.');\n      }\n\n      return (\n        /*#__PURE__*/\n        function () {\n          var _ref6 = (0, _asyncToGenerator2.default)(\n          /*#__PURE__*/\n          _regenerator.default.mark(function _callee2(req, res, next) {\n            var token, authorizationHeader, authorizationQuery, _authorizationHeader$, _authorizationHeader$2, authorizationType, authorizationValue, decodedToken;\n\n            return _regenerator.default.wrap(function _callee2$(_context2) {\n              while (1) {\n                switch (_context2.prev = _context2.next) {\n                  case 0:\n                    authorizationHeader = req.headers.authorization, authorizationQuery = req.query.token;\n\n                    if (authorizationHeader) {\n                      _authorizationHeader$ = authorizationHeader.split(' '), _authorizationHeader$2 = (0, _slicedToArray2.default)(_authorizationHeader$, 2), authorizationType = _authorizationHeader$2[0], authorizationValue = _authorizationHeader$2[1];\n\n                      if (authorizationType === 'Bearer') {\n                        token = authorizationValue;\n                      }\n                    } else if (authorizationQuery) {\n                      token = authorizationQuery;\n                    }\n\n                    if (!token) {\n                      _context2.next = 14;\n                      break;\n                    }\n\n                    _context2.prev = 3;\n                    _context2.next = 6;\n                    return _this.verifyToken({\n                      token: token\n                    });\n\n                  case 6:\n                    decodedToken = _context2.sent;\n                    _context2.next = 12;\n                    break;\n\n                  case 9:\n                    _context2.prev = 9;\n                    _context2.t0 = _context2[\"catch\"](3);\n                    return _context2.abrupt(\"return\", res.status(401).end());\n\n                  case 12:\n                    _context2.next = 15;\n                    break;\n\n                  case 14:\n                    decodedToken = Limes.issueUntrustedTokenAsJson({\n                      issuer: issuerForAnonymousTokens,\n                      subject: 'anonymous'\n                    });\n\n                  case 15:\n                    req.user = decodedToken;\n                    next();\n\n                  case 17:\n                  case \"end\":\n                    return _context2.stop();\n                }\n              }\n            }, _callee2, null, [[3, 9]]);\n          }));\n\n          return function (_x2, _x3, _x4) {\n            return _ref6.apply(this, arguments);\n          };\n        }()\n      );\n    }\n  }], [{\n    key: \"issueUntrustedTokenAsJson\",\n    value: function issueUntrustedTokenAsJson(_ref7) {\n      var issuer = _ref7.issuer,\n          subject = _ref7.subject,\n          _ref7$payload = _ref7.payload,\n          payload = _ref7$payload === void 0 ? {} : _ref7$payload;\n\n      if (!issuer) {\n        throw new Error('Issuer is missing.');\n      }\n\n      if (!subject) {\n        throw new Error('Subject is missing.');\n      }\n\n      var expiresInMinutes = 60;\n      var encodedToken = jwt.sign(payload, null, {\n        algorithm: 'none',\n        subject: subject,\n        issuer: issuer,\n        expiresIn: expiresInMinutes * 60\n      });\n      var token = jwt.decode(encodedToken);\n      return token;\n    }\n  }]);\n  return Limes;\n}();\n\nLimes.IdentityProvider = IdentityProvider;\nmodule.exports = Limes;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}