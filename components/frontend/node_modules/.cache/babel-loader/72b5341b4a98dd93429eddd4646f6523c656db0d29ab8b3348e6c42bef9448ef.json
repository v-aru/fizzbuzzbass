{"ast":null,"code":"'use strict';\n\nvar crypto = require('crypto'),\n  timeSafeCompare = require('tsscmp');\nvar LENGTH = 10;\nfunction create(req, secretKey) {\n  var session = req.session;\n  if (session === undefined) {\n    throw new Error('lusca requires req.session to be available in order to maintain state');\n  }\n  var secret = session[secretKey];\n  // Save the secret for validation\n  if (!secret) {\n    session[secretKey] = crypto.pseudoRandomBytes(LENGTH).toString('base64');\n    secret = session[secretKey];\n  }\n  return {\n    secret: secret,\n    token: tokenize(salt(LENGTH), secret),\n    validate: function validate(req, token) {\n      if (typeof token !== 'string') {\n        return false;\n      }\n      return timeSafeCompare(token, tokenize(token.slice(0, LENGTH), req.session[secretKey]));\n    }\n  };\n}\nfunction tokenize(salt, secret) {\n  return salt + crypto.createHash('sha1').update(salt + secret).digest('base64');\n}\nfunction salt(len) {\n  var str = '',\n    chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  for (var i = 0; i < len; i++) {\n    str += chars[Math.floor(Math.random() * chars.length)];\n  }\n  return str;\n}\nmodule.exports = {\n  create: create\n};","map":{"version":3,"names":["crypto","require","timeSafeCompare","LENGTH","create","req","secretKey","session","undefined","Error","secret","pseudoRandomBytes","toString","token","tokenize","salt","validate","slice","createHash","update","digest","len","str","chars","i","Math","floor","random","length","module","exports"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/lusca/lib/token.js"],"sourcesContent":["'use strict';\n\n\nvar crypto = require('crypto'),\n    timeSafeCompare = require('tsscmp');\nvar LENGTH = 10;\n\n\n\nfunction create(req, secretKey) {\n\n    var session = req.session;\n    if (session === undefined) {\n        throw new Error('lusca requires req.session to be available in order to maintain state');\n    }\n    var secret = session[secretKey];\n    // Save the secret for validation\n    if (!secret) {\n        session[secretKey] = crypto.pseudoRandomBytes(LENGTH).toString('base64');\n        secret = session[secretKey];\n    }\n\n    return {\n        secret: secret,\n        token: tokenize(salt(LENGTH), secret),\n        validate: function validate(req, token) {\n            if (typeof token !== 'string') {\n                return false;\n\n            }\n            return timeSafeCompare(token, tokenize(token.slice(0, LENGTH),\n                                         req.session[secretKey]));\n        }\n    };\n}\n\nfunction tokenize(salt, secret) {\n    return salt + crypto.createHash('sha1').update(salt + secret).digest('base64');\n}\n\n\nfunction salt(len) {\n    var str = '',\n        chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n    for (var i = 0; i < len; i++) {\n        str += chars[Math.floor(Math.random() * chars.length)];\n    }\n\n    return str;\n}\n\n\n\nmodule.exports = {\n    create: create\n};\n"],"mappings":"AAAA,YAAY;;AAGZ,IAAIA,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;EAC1BC,eAAe,GAAGD,OAAO,CAAC,QAAQ,CAAC;AACvC,IAAIE,MAAM,GAAG,EAAE;AAIf,SAASC,MAAMA,CAACC,GAAG,EAAEC,SAAS,EAAE;EAE5B,IAAIC,OAAO,GAAGF,GAAG,CAACE,OAAO;EACzB,IAAIA,OAAO,KAAKC,SAAS,EAAE;IACvB,MAAM,IAAIC,KAAK,CAAC,uEAAuE,CAAC;EAC5F;EACA,IAAIC,MAAM,GAAGH,OAAO,CAACD,SAAS,CAAC;EAC/B;EACA,IAAI,CAACI,MAAM,EAAE;IACTH,OAAO,CAACD,SAAS,CAAC,GAAGN,MAAM,CAACW,iBAAiB,CAACR,MAAM,CAAC,CAACS,QAAQ,CAAC,QAAQ,CAAC;IACxEF,MAAM,GAAGH,OAAO,CAACD,SAAS,CAAC;EAC/B;EAEA,OAAO;IACHI,MAAM,EAAEA,MAAM;IACdG,KAAK,EAAEC,QAAQ,CAACC,IAAI,CAACZ,MAAM,CAAC,EAAEO,MAAM,CAAC;IACrCM,QAAQ,EAAE,SAASA,QAAQA,CAACX,GAAG,EAAEQ,KAAK,EAAE;MACpC,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;QAC3B,OAAO,KAAK;MAEhB;MACA,OAAOX,eAAe,CAACW,KAAK,EAAEC,QAAQ,CAACD,KAAK,CAACI,KAAK,CAAC,CAAC,EAAEd,MAAM,CAAC,EAChCE,GAAG,CAACE,OAAO,CAACD,SAAS,CAAC,CAAC,CAAC;IACzD;EACJ,CAAC;AACL;AAEA,SAASQ,QAAQA,CAACC,IAAI,EAAEL,MAAM,EAAE;EAC5B,OAAOK,IAAI,GAAGf,MAAM,CAACkB,UAAU,CAAC,MAAM,CAAC,CAACC,MAAM,CAACJ,IAAI,GAAGL,MAAM,CAAC,CAACU,MAAM,CAAC,QAAQ,CAAC;AAClF;AAGA,SAASL,IAAIA,CAACM,GAAG,EAAE;EACf,IAAIC,GAAG,GAAG,EAAE;IACRC,KAAK,GAAG,gEAAgE;EAE5E,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGH,GAAG,EAAEG,CAAC,EAAE,EAAE;IAC1BF,GAAG,IAAIC,KAAK,CAACE,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAGJ,KAAK,CAACK,MAAM,CAAC,CAAC;EAC1D;EAEA,OAAON,GAAG;AACd;AAIAO,MAAM,CAACC,OAAO,GAAG;EACb1B,MAAM,EAAEA;AACZ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}