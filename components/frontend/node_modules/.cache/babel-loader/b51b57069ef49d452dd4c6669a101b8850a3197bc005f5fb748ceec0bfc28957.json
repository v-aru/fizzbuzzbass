{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar fs = require('fs'),\n  http = require('http');\nvar bodyParser = require('body-parser'),\n  compression = require('compression'),\n  cors = require('cors'),\n  express = require('express'),\n  flaschenpost = require('flaschenpost'),\n  flatten = require('lodash/flatten'),\n  lusca = require('lusca'),\n  morgan = require('morgan'),\n  nocache = require('nocache');\nvar v1 = require('./v1'),\n  wsServer = require('./wsServer');\nvar Server = /*#__PURE__*/\nfunction () {\n  function Server(_ref) {\n    var port = _ref.port,\n      corsOrigin = _ref.corsOrigin,\n      readModel = _ref.readModel,\n      serveStatic = _ref.serveStatic,\n      writeModel = _ref.writeModel;\n    (0, _classCallCheck2.default)(this, Server);\n    if (!port) {\n      throw new Error('Port is missing.');\n    }\n    if (!corsOrigin) {\n      throw new Error('CORS origin is missing.');\n    }\n    if (corsOrigin === '*') {\n      this.corsOrigin = corsOrigin;\n    } else {\n      this.corsOrigin = flatten([corsOrigin]);\n    }\n    if (serveStatic) {\n      var staticPath;\n      try {\n        /* eslint-disable no-sync */\n        staticPath = fs.lstatSync(serveStatic);\n        /* eslint-enble no-sync */\n      } catch (ex) {\n        throw new Error('Serve static is not a valid path.');\n      }\n      if (!staticPath.isDirectory()) {\n        throw new Error('Serve static is not a directory.');\n      }\n    }\n    this.port = port;\n    this.readModel = readModel;\n    this.serveStatic = serveStatic;\n    this.writeModel = writeModel;\n  }\n  (0, _createClass2.default)(Server, [{\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)(/*#__PURE__*/\n      _regenerator.default.mark(function _callee(app, incoming, outgoing) {\n        var readModel, writeModel, port, serveStatic, logger, api, server;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (app) {\n                  _context.next = 2;\n                  break;\n                }\n                throw new Error('App is missing.');\n              case 2:\n                if (incoming) {\n                  _context.next = 4;\n                  break;\n                }\n                throw new Error('Incoming is missing.');\n              case 4:\n                if (outgoing) {\n                  _context.next = 6;\n                  break;\n                }\n                throw new Error('Outgoing is missing.');\n              case 6:\n                readModel = this.readModel, writeModel = this.writeModel, port = this.port, serveStatic = this.serveStatic;\n                logger = app.services.getLogger();\n                api = express();\n                api.use(morgan('tiny', {\n                  stream: new flaschenpost.Middleware('debug')\n                }));\n                api.use(lusca.xframe('DENY'));\n                api.use(lusca.xssProtection());\n                api.options('*', cors({\n                  methods: ['GET', 'POST'],\n                  origin: this.corsOrigin,\n                  optionsSuccessStatus: 200\n                }));\n                api.use(cors({\n                  methods: ['GET', 'POST'],\n                  origin: this.corsOrigin,\n                  optionsSuccessStatus: 200\n                }));\n                api.use(nocache());\n                api.use(bodyParser.json({\n                  limit: '100kb'\n                }));\n                api.use('/v1', v1(app, {\n                  readModel: readModel,\n                  writeModel: writeModel\n                }));\n                if (serveStatic) {\n                  api.use(compression());\n                  api.use('/', express.static(serveStatic));\n                }\n                server = http.createServer(api);\n                wsServer({\n                  httpServer: server,\n                  app: app,\n                  readModel: readModel,\n                  writeModel: writeModel\n                });\n                _context.next = 22;\n                return new Promise(function (resolve) {\n                  server.listen(port, function () {\n                    logger.debug('Started API endpoint.', {\n                      port: port\n                    });\n                    resolve();\n                  });\n                });\n              case 22:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n      function link(_x, _x2, _x3) {\n        return _link.apply(this, arguments);\n      }\n      return link;\n    }()\n  }]);\n  return Server;\n}();\nmodule.exports = Server;","map":{"version":3,"names":["_interopRequireDefault","require","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","fs","http","bodyParser","compression","cors","express","flaschenpost","flatten","lusca","morgan","nocache","v1","wsServer","Server","_ref","port","corsOrigin","readModel","serveStatic","writeModel","default","Error","staticPath","lstatSync","ex","isDirectory","key","value","_link","mark","_callee","app","incoming","outgoing","logger","api","server","wrap","_callee$","_context","prev","next","services","getLogger","use","stream","Middleware","xframe","xssProtection","options","methods","origin","optionsSuccessStatus","json","limit","static","createServer","httpServer","Promise","resolve","listen","debug","stop","link","_x","_x2","_x3","apply","arguments","module","exports"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/tailwind/dist/wires/api/http/Server.js"],"sourcesContent":["'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar fs = require('fs'),\n    http = require('http');\n\nvar bodyParser = require('body-parser'),\n    compression = require('compression'),\n    cors = require('cors'),\n    express = require('express'),\n    flaschenpost = require('flaschenpost'),\n    flatten = require('lodash/flatten'),\n    lusca = require('lusca'),\n    morgan = require('morgan'),\n    nocache = require('nocache');\n\nvar v1 = require('./v1'),\n    wsServer = require('./wsServer');\n\nvar Server =\n/*#__PURE__*/\nfunction () {\n  function Server(_ref) {\n    var port = _ref.port,\n        corsOrigin = _ref.corsOrigin,\n        readModel = _ref.readModel,\n        serveStatic = _ref.serveStatic,\n        writeModel = _ref.writeModel;\n    (0, _classCallCheck2.default)(this, Server);\n\n    if (!port) {\n      throw new Error('Port is missing.');\n    }\n\n    if (!corsOrigin) {\n      throw new Error('CORS origin is missing.');\n    }\n\n    if (corsOrigin === '*') {\n      this.corsOrigin = corsOrigin;\n    } else {\n      this.corsOrigin = flatten([corsOrigin]);\n    }\n\n    if (serveStatic) {\n      var staticPath;\n\n      try {\n        /* eslint-disable no-sync */\n        staticPath = fs.lstatSync(serveStatic);\n        /* eslint-enble no-sync */\n      } catch (ex) {\n        throw new Error('Serve static is not a valid path.');\n      }\n\n      if (!staticPath.isDirectory()) {\n        throw new Error('Serve static is not a directory.');\n      }\n    }\n\n    this.port = port;\n    this.readModel = readModel;\n    this.serveStatic = serveStatic;\n    this.writeModel = writeModel;\n  }\n\n  (0, _createClass2.default)(Server, [{\n    key: \"link\",\n    value: function () {\n      var _link = (0, _asyncToGenerator2.default)(\n      /*#__PURE__*/\n      _regenerator.default.mark(function _callee(app, incoming, outgoing) {\n        var readModel, writeModel, port, serveStatic, logger, api, server;\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (app) {\n                  _context.next = 2;\n                  break;\n                }\n\n                throw new Error('App is missing.');\n\n              case 2:\n                if (incoming) {\n                  _context.next = 4;\n                  break;\n                }\n\n                throw new Error('Incoming is missing.');\n\n              case 4:\n                if (outgoing) {\n                  _context.next = 6;\n                  break;\n                }\n\n                throw new Error('Outgoing is missing.');\n\n              case 6:\n                readModel = this.readModel, writeModel = this.writeModel, port = this.port, serveStatic = this.serveStatic;\n                logger = app.services.getLogger();\n                api = express();\n                api.use(morgan('tiny', {\n                  stream: new flaschenpost.Middleware('debug')\n                }));\n                api.use(lusca.xframe('DENY'));\n                api.use(lusca.xssProtection());\n                api.options('*', cors({\n                  methods: ['GET', 'POST'],\n                  origin: this.corsOrigin,\n                  optionsSuccessStatus: 200\n                }));\n                api.use(cors({\n                  methods: ['GET', 'POST'],\n                  origin: this.corsOrigin,\n                  optionsSuccessStatus: 200\n                }));\n                api.use(nocache());\n                api.use(bodyParser.json({\n                  limit: '100kb'\n                }));\n                api.use('/v1', v1(app, {\n                  readModel: readModel,\n                  writeModel: writeModel\n                }));\n\n                if (serveStatic) {\n                  api.use(compression());\n                  api.use('/', express.static(serveStatic));\n                }\n\n                server = http.createServer(api);\n                wsServer({\n                  httpServer: server,\n                  app: app,\n                  readModel: readModel,\n                  writeModel: writeModel\n                });\n                _context.next = 22;\n                return new Promise(function (resolve) {\n                  server.listen(port, function () {\n                    logger.debug('Started API endpoint.', {\n                      port: port\n                    });\n                    resolve();\n                  });\n                });\n\n              case 22:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function link(_x, _x2, _x3) {\n        return _link.apply(this, arguments);\n      }\n\n      return link;\n    }()\n  }]);\n  return Server;\n}();\n\nmodule.exports = Server;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}