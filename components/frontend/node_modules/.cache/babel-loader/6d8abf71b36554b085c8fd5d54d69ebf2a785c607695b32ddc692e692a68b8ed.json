{"ast":null,"code":"/*───────────────────────────────────────────────────────────────────────────*\\\n│  Copyright (C) 2016 PayPal                                                  │\n│                                                                             │\n│hh ,'\"\"`.                                                                    │\n│  / _  _ \\  Licensed under the Apache License, Version 2.0 (the \"License\");  │\n│  |(@)(@)|  you may not use this file except in compliance with the License. │\n│  )  __  (  You may obtain a copy of the License at                          │\n│ /,'))((`.\\                                                                  │\n│(( ((  )) ))    http://www.apache.org/licenses/LICENSE-2.0                   │\n│ `\\ `)(' /'                                                                  │\n│                                                                             │\n│   Unless required by applicable law or agreed to in writing, software       │\n│   distributed under the License is distributed on an \"AS IS\" BASIS,         │\n│   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  │\n│   See the License for the specific language governing permissions and       │\n│   limitations under the License.                                            │\n\\*───────────────────────────────────────────────────────────────────────────*/\n'use strict';\n\nvar crypto = require('crypto');\n\n/**\n * Outputs all security headers based on configuration\n * @param {Object} options The configuration object.\n */\nvar lusca = module.exports = function (options) {\n  var headers = [];\n  var nonce;\n  if (options) {\n    Object.keys(lusca).forEach(function (key) {\n      var config = options[key];\n      if (key === \"csp\" && options[key] && (options[key]['styleNonce'] || options[key]['scriptNonce'])) {\n        nonce = true;\n      }\n      if (config) {\n        headers.push(lusca[key](config));\n      }\n    });\n  }\n  return function lusca(req, res, next) {\n    var chain = next;\n    if (nonce) {\n      Object.defineProperty(res.locals, 'nonce', {\n        value: crypto.pseudoRandomBytes(36).toString('base64'),\n        enumerable: true\n      });\n    }\n    headers.forEach(function (header) {\n      chain = function (next) {\n        return function (err) {\n          if (err) {\n            next(err);\n            return;\n          }\n          return header(req, res, next);\n        };\n      }(chain);\n    });\n    chain();\n  };\n};\nlusca.csrf = require('./lib/csrf');\nlusca.csp = require('./lib/csp');\nlusca.hsts = require('./lib/hsts');\nlusca.p3p = require('./lib/p3p');\nlusca.xframe = require('./lib/xframes');\nlusca.xssProtection = require('./lib/xssprotection');\nlusca.nosniff = require('./lib/nosniff');\nlusca.referrerPolicy = require('./lib/referrerpolicy');","map":{"version":3,"names":["crypto","require","lusca","module","exports","options","headers","nonce","Object","keys","forEach","key","config","push","req","res","next","chain","defineProperty","locals","value","pseudoRandomBytes","toString","enumerable","header","err","csrf","csp","hsts","p3p","xframe","xssProtection","nosniff","referrerPolicy"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/lusca/index.js"],"sourcesContent":["/*───────────────────────────────────────────────────────────────────────────*\\\n│  Copyright (C) 2016 PayPal                                                  │\n│                                                                             │\n│hh ,'\"\"`.                                                                    │\n│  / _  _ \\  Licensed under the Apache License, Version 2.0 (the \"License\");  │\n│  |(@)(@)|  you may not use this file except in compliance with the License. │\n│  )  __  (  You may obtain a copy of the License at                          │\n│ /,'))((`.\\                                                                  │\n│(( ((  )) ))    http://www.apache.org/licenses/LICENSE-2.0                   │\n│ `\\ `)(' /'                                                                  │\n│                                                                             │\n│   Unless required by applicable law or agreed to in writing, software       │\n│   distributed under the License is distributed on an \"AS IS\" BASIS,         │\n│   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  │\n│   See the License for the specific language governing permissions and       │\n│   limitations under the License.                                            │\n\\*───────────────────────────────────────────────────────────────────────────*/\n'use strict';\nvar crypto  = require('crypto');\n\n\n/**\n * Outputs all security headers based on configuration\n * @param {Object} options The configuration object.\n */\nvar lusca = module.exports = function (options) {\n    var headers = [];\n    var nonce;\n\n    if (options) {\n        Object.keys(lusca).forEach(function (key) {\n            var config = options[key];\n            if (key === \"csp\" && options[key] && (options[key]['styleNonce'] || options[key]['scriptNonce'])) {\n                nonce = true;\n            }\n\n            if (config) {\n                headers.push(lusca[key](config));\n            }\n        });\n    }\n\n    return function lusca(req, res, next) {\n        var chain = next;\n\n        if (nonce) {\n            Object.defineProperty(res.locals, 'nonce', {\n                value: crypto.pseudoRandomBytes(36).toString('base64'),\n                enumerable: true\n            });\n        }\n        headers.forEach(function (header) {\n            chain = (function (next) {\n                return function (err) {\n                    if (err) {\n                        next(err);\n                        return;\n                    }\n                    return header(req, res, next);\n                };\n            }(chain));\n        });\n\n        chain();\n    };\n};\n\n\nlusca.csrf = require('./lib/csrf');\nlusca.csp = require('./lib/csp');\nlusca.hsts = require('./lib/hsts');\nlusca.p3p = require('./lib/p3p');\nlusca.xframe = require('./lib/xframes');\nlusca.xssProtection = require('./lib/xssprotection');\nlusca.nosniff = require('./lib/nosniff');\nlusca.referrerPolicy = require('./lib/referrerpolicy');\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;;AACZ,IAAIA,MAAM,GAAIC,OAAO,CAAC,QAAQ,CAAC;;AAG/B;AACA;AACA;AACA;AACA,IAAIC,KAAK,GAAGC,MAAM,CAACC,OAAO,GAAG,UAAUC,OAAO,EAAE;EAC5C,IAAIC,OAAO,GAAG,EAAE;EAChB,IAAIC,KAAK;EAET,IAAIF,OAAO,EAAE;IACTG,MAAM,CAACC,IAAI,CAACP,KAAK,CAAC,CAACQ,OAAO,CAAC,UAAUC,GAAG,EAAE;MACtC,IAAIC,MAAM,GAAGP,OAAO,CAACM,GAAG,CAAC;MACzB,IAAIA,GAAG,KAAK,KAAK,IAAIN,OAAO,CAACM,GAAG,CAAC,KAAKN,OAAO,CAACM,GAAG,CAAC,CAAC,YAAY,CAAC,IAAIN,OAAO,CAACM,GAAG,CAAC,CAAC,aAAa,CAAC,CAAC,EAAE;QAC9FJ,KAAK,GAAG,IAAI;MAChB;MAEA,IAAIK,MAAM,EAAE;QACRN,OAAO,CAACO,IAAI,CAACX,KAAK,CAACS,GAAG,CAAC,CAACC,MAAM,CAAC,CAAC;MACpC;IACJ,CAAC,CAAC;EACN;EAEA,OAAO,SAASV,KAAKA,CAACY,GAAG,EAAEC,GAAG,EAAEC,IAAI,EAAE;IAClC,IAAIC,KAAK,GAAGD,IAAI;IAEhB,IAAIT,KAAK,EAAE;MACPC,MAAM,CAACU,cAAc,CAACH,GAAG,CAACI,MAAM,EAAE,OAAO,EAAE;QACvCC,KAAK,EAAEpB,MAAM,CAACqB,iBAAiB,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,QAAQ,CAAC;QACtDC,UAAU,EAAE;MAChB,CAAC,CAAC;IACN;IACAjB,OAAO,CAACI,OAAO,CAAC,UAAUc,MAAM,EAAE;MAC9BP,KAAK,GAAI,UAAUD,IAAI,EAAE;QACrB,OAAO,UAAUS,GAAG,EAAE;UAClB,IAAIA,GAAG,EAAE;YACLT,IAAI,CAACS,GAAG,CAAC;YACT;UACJ;UACA,OAAOD,MAAM,CAACV,GAAG,EAAEC,GAAG,EAAEC,IAAI,CAAC;QACjC,CAAC;MACL,CAAC,CAACC,KAAK,CAAE;IACb,CAAC,CAAC;IAEFA,KAAK,CAAC,CAAC;EACX,CAAC;AACL,CAAC;AAGDf,KAAK,CAACwB,IAAI,GAAGzB,OAAO,CAAC,YAAY,CAAC;AAClCC,KAAK,CAACyB,GAAG,GAAG1B,OAAO,CAAC,WAAW,CAAC;AAChCC,KAAK,CAAC0B,IAAI,GAAG3B,OAAO,CAAC,YAAY,CAAC;AAClCC,KAAK,CAAC2B,GAAG,GAAG5B,OAAO,CAAC,WAAW,CAAC;AAChCC,KAAK,CAAC4B,MAAM,GAAG7B,OAAO,CAAC,eAAe,CAAC;AACvCC,KAAK,CAAC6B,aAAa,GAAG9B,OAAO,CAAC,qBAAqB,CAAC;AACpDC,KAAK,CAAC8B,OAAO,GAAG/B,OAAO,CAAC,eAAe,CAAC;AACxCC,KAAK,CAAC+B,cAAc,GAAGhC,OAAO,CAAC,sBAAsB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}