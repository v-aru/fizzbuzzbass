{"ast":null,"code":"'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\nvar formats = require('formats'),\n  uuid = require('uuidv4');\nvar Command = /*#__PURE__*/\nfunction () {\n  function Command(_ref) {\n    var context = _ref.context,\n      aggregate = _ref.aggregate,\n      name = _ref.name,\n      _ref$data = _ref.data,\n      data = _ref$data === void 0 ? {} : _ref$data,\n      _ref$custom = _ref.custom,\n      custom = _ref$custom === void 0 ? {} : _ref$custom;\n    (0, _classCallCheck2.default)(this, Command);\n    if (!context) {\n      throw new Error('Context is missing.');\n    }\n    if (!context.name) {\n      throw new Error('Context name is missing.');\n    }\n    if (!aggregate) {\n      throw new Error('Aggregate is missing.');\n    }\n    if (!aggregate.name) {\n      throw new Error('Aggregate name is missing.');\n    }\n    if (!aggregate.id) {\n      throw new Error('Aggregate id is missing.');\n    }\n    if (!name) {\n      throw new Error('Command name is missing.');\n    }\n    if (!formats.isObject(context)) {\n      throw new Error('Context must be an object.');\n    }\n    if (!formats.isAlphanumeric(context.name, {\n      minLength: 1\n    })) {\n      throw new Error('Context name must be an alphanumeric string.');\n    }\n    if (!formats.isObject(aggregate)) {\n      throw new Error('Aggregate must be an object.');\n    }\n    if (!formats.isAlphanumeric(aggregate.name, {\n      minLength: 1\n    })) {\n      throw new Error('Aggregate name must be an alphanumeric string.');\n    }\n    if (!formats.isUuid(aggregate.id)) {\n      throw new Error('Aggregate id must be a uuid.');\n    }\n    if (!formats.isAlphanumeric(name, {\n      minLength: 1\n    })) {\n      throw new Error('Command name must be an alphanumeric string.');\n    }\n    if (!formats.isObject(data)) {\n      throw new Error('Data must be an object.');\n    }\n    if (!formats.isObject(custom)) {\n      throw new Error('Custom must be an object.');\n    }\n    this.context = {\n      name: context.name\n    };\n    this.aggregate = {\n      name: aggregate.name,\n      id: aggregate.id\n    };\n    this.name = name;\n    this.id = uuid();\n    this.data = data;\n    this.custom = custom;\n    this.user = null;\n    this.metadata = {\n      timestamp: Date.now(),\n      correlationId: this.id,\n      causationId: this.id\n    };\n  }\n  (0, _createClass2.default)(Command, [{\n    key: \"addToken\",\n    value: function addToken(token) {\n      if (!token) {\n        throw new Error('Token is missing.');\n      }\n      if (!token.sub) {\n        throw new Error('Sub claim is missing.');\n      }\n      this.user = {\n        id: token.sub,\n        token: token\n      };\n    }\n  }]);\n  return Command;\n}();\nCommand.wrap = function (_ref2) {\n  var context = _ref2.context,\n    aggregate = _ref2.aggregate,\n    name = _ref2.name,\n    id = _ref2.id,\n    metadata = _ref2.metadata,\n    user = _ref2.user,\n    _ref2$data = _ref2.data,\n    data = _ref2$data === void 0 ? {} : _ref2$data,\n    _ref2$custom = _ref2.custom,\n    custom = _ref2$custom === void 0 ? {} : _ref2$custom;\n  var command = new Command({\n    context: context,\n    aggregate: aggregate,\n    name: name,\n    data: data,\n    custom: custom\n  });\n  command.id = id;\n  command.metadata.timestamp = metadata.timestamp;\n  command.metadata.correlationId = metadata.correlationId;\n  command.metadata.causationId = metadata.causationId;\n  if (user && user.token) {\n    command.addToken(user.token);\n  }\n  if (!Command.isWellformed(command)) {\n    throw new Error('Command is malformed.');\n  }\n  return command;\n};\nCommand.isWellformed = function (command) {\n  return formats.isObject(command, {\n    schema: {\n      context: formats.object({\n        schema: {\n          name: formats.alphanumeric({\n            minLength: 1\n          })\n        }\n      }),\n      aggregate: formats.object({\n        schema: {\n          name: formats.alphanumeric({\n            minLength: 1\n          }),\n          id: formats.uuid()\n        }\n      }),\n      name: formats.alphanumeric({\n        minLength: 1\n      }),\n      id: formats.uuid(),\n      data: formats.object({\n        schema: {},\n        isSchemaRelaxed: true\n      }),\n      custom: formats.object({\n        schema: {},\n        isSchemaRelaxed: true\n      }),\n      user: formats.object({\n        schema: {\n          id: formats.string({\n            minLength: 1\n          }),\n          token: formats.object({\n            schema: {\n              sub: formats.string({\n                minLength: 1\n              })\n            },\n            isSchemaRelaxed: true\n          })\n        },\n        isOptional: true\n      }),\n      metadata: formats.object({\n        schema: {\n          timestamp: formats.number(),\n          correlationId: formats.uuid(),\n          causationId: formats.uuid()\n        }\n      })\n    }\n  });\n};\nmodule.exports = Command;","map":{"version":3,"names":["_interopRequireDefault","require","_classCallCheck2","_createClass2","formats","uuid","Command","_ref","context","aggregate","name","_ref$data","data","_ref$custom","custom","default","Error","id","isObject","isAlphanumeric","minLength","isUuid","user","metadata","timestamp","Date","now","correlationId","causationId","key","value","addToken","token","sub","wrap","_ref2","_ref2$data","_ref2$custom","command","isWellformed","schema","object","alphanumeric","isSchemaRelaxed","string","isOptional","number","module","exports"],"sources":["/Users/anandarunima/Documents/Arunima/Coursework/sauce_labs-fizzbuzzbash/fizzbuzzbass/components/node_modules/commands-events/dist/Command.js"],"sourcesContent":["'use strict';\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar formats = require('formats'),\n    uuid = require('uuidv4');\n\nvar Command =\n/*#__PURE__*/\nfunction () {\n  function Command(_ref) {\n    var context = _ref.context,\n        aggregate = _ref.aggregate,\n        name = _ref.name,\n        _ref$data = _ref.data,\n        data = _ref$data === void 0 ? {} : _ref$data,\n        _ref$custom = _ref.custom,\n        custom = _ref$custom === void 0 ? {} : _ref$custom;\n    (0, _classCallCheck2.default)(this, Command);\n\n    if (!context) {\n      throw new Error('Context is missing.');\n    }\n\n    if (!context.name) {\n      throw new Error('Context name is missing.');\n    }\n\n    if (!aggregate) {\n      throw new Error('Aggregate is missing.');\n    }\n\n    if (!aggregate.name) {\n      throw new Error('Aggregate name is missing.');\n    }\n\n    if (!aggregate.id) {\n      throw new Error('Aggregate id is missing.');\n    }\n\n    if (!name) {\n      throw new Error('Command name is missing.');\n    }\n\n    if (!formats.isObject(context)) {\n      throw new Error('Context must be an object.');\n    }\n\n    if (!formats.isAlphanumeric(context.name, {\n      minLength: 1\n    })) {\n      throw new Error('Context name must be an alphanumeric string.');\n    }\n\n    if (!formats.isObject(aggregate)) {\n      throw new Error('Aggregate must be an object.');\n    }\n\n    if (!formats.isAlphanumeric(aggregate.name, {\n      minLength: 1\n    })) {\n      throw new Error('Aggregate name must be an alphanumeric string.');\n    }\n\n    if (!formats.isUuid(aggregate.id)) {\n      throw new Error('Aggregate id must be a uuid.');\n    }\n\n    if (!formats.isAlphanumeric(name, {\n      minLength: 1\n    })) {\n      throw new Error('Command name must be an alphanumeric string.');\n    }\n\n    if (!formats.isObject(data)) {\n      throw new Error('Data must be an object.');\n    }\n\n    if (!formats.isObject(custom)) {\n      throw new Error('Custom must be an object.');\n    }\n\n    this.context = {\n      name: context.name\n    };\n    this.aggregate = {\n      name: aggregate.name,\n      id: aggregate.id\n    };\n    this.name = name;\n    this.id = uuid();\n    this.data = data;\n    this.custom = custom;\n    this.user = null;\n    this.metadata = {\n      timestamp: Date.now(),\n      correlationId: this.id,\n      causationId: this.id\n    };\n  }\n\n  (0, _createClass2.default)(Command, [{\n    key: \"addToken\",\n    value: function addToken(token) {\n      if (!token) {\n        throw new Error('Token is missing.');\n      }\n\n      if (!token.sub) {\n        throw new Error('Sub claim is missing.');\n      }\n\n      this.user = {\n        id: token.sub,\n        token: token\n      };\n    }\n  }]);\n  return Command;\n}();\n\nCommand.wrap = function (_ref2) {\n  var context = _ref2.context,\n      aggregate = _ref2.aggregate,\n      name = _ref2.name,\n      id = _ref2.id,\n      metadata = _ref2.metadata,\n      user = _ref2.user,\n      _ref2$data = _ref2.data,\n      data = _ref2$data === void 0 ? {} : _ref2$data,\n      _ref2$custom = _ref2.custom,\n      custom = _ref2$custom === void 0 ? {} : _ref2$custom;\n  var command = new Command({\n    context: context,\n    aggregate: aggregate,\n    name: name,\n    data: data,\n    custom: custom\n  });\n  command.id = id;\n  command.metadata.timestamp = metadata.timestamp;\n  command.metadata.correlationId = metadata.correlationId;\n  command.metadata.causationId = metadata.causationId;\n\n  if (user && user.token) {\n    command.addToken(user.token);\n  }\n\n  if (!Command.isWellformed(command)) {\n    throw new Error('Command is malformed.');\n  }\n\n  return command;\n};\n\nCommand.isWellformed = function (command) {\n  return formats.isObject(command, {\n    schema: {\n      context: formats.object({\n        schema: {\n          name: formats.alphanumeric({\n            minLength: 1\n          })\n        }\n      }),\n      aggregate: formats.object({\n        schema: {\n          name: formats.alphanumeric({\n            minLength: 1\n          }),\n          id: formats.uuid()\n        }\n      }),\n      name: formats.alphanumeric({\n        minLength: 1\n      }),\n      id: formats.uuid(),\n      data: formats.object({\n        schema: {},\n        isSchemaRelaxed: true\n      }),\n      custom: formats.object({\n        schema: {},\n        isSchemaRelaxed: true\n      }),\n      user: formats.object({\n        schema: {\n          id: formats.string({\n            minLength: 1\n          }),\n          token: formats.object({\n            schema: {\n              sub: formats.string({\n                minLength: 1\n              })\n            },\n            isSchemaRelaxed: true\n          })\n        },\n        isOptional: true\n      }),\n      metadata: formats.object({\n        schema: {\n          timestamp: formats.number(),\n          correlationId: formats.uuid(),\n          causationId: formats.uuid()\n        }\n      })\n    }\n  });\n};\n\nmodule.exports = Command;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}